{# templates/otherProfile.html.twig #}
{% include 'header.html.twig' with {'genres':genres, 'userPfp': userPfp} %}
{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/bootstrap.css') }}">
    <link rel="stylesheet" href="{{ asset('css/Stories.css') }}">
    <link rel="stylesheet" href="{{ asset('css/ComonStyles.css') }}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&display=swap">
{% endblock %}
{% block body %}
    {% if user is defined and user is not null and user.userId != 161 %}
            <h1>{{ user.username }}'s profile</h1>
    {% endif %}
    <div class="container card">
    {% if user is defined and user is not null %}
        {% if user.userId == 161 %}
            User not found
        {% else %}
        <div class="primero">
            <div id='usersite d-flex flex-row'>
                <div id='pfp'>
                    {% if otherUserPhoto is not null %}
                        <img src="{{ otherUserPhoto }}" alt="User Picture" style='width: 100px; height: auto;' id="otherUser">
                    {% else %}
                        <img src="{{ asset('Images/user.png') }}" alt="User Picture" style='width: 100px; height: auto;' id="otherUser">
                    {% endif %}
                </div>
                <div id='about'>
                    <p id='buser'>About {{ user.username }}:
                    <p class='text'><pre>{{ user.about }}</pre></p>
                </div>
            </div>
        <div>
            <h2>{{ user.username }}'s stories:</h2>
            {% if user.stories is defined and user.stories|length > 0 %}
                {% set storiesNumber = 0 %}
                {% for story in user.stories %}
                    {% if story.public == 1 %}
                        <div class="card m-3 card-profile">
                            <div class="card-header">
                                <h3><a href="{{ path('seeStory', {'id': story.storyID}) }}"> {{ story.storyTitle }} </a></h3>
                            </div>
                            <div class="card-body">
                                <h5 class="card-title">Author(s):
                                    {% if story.user.userId == 161 %}
                                        DELETED
                                    {% else %}
                                        <a href="{{ path('otherProfile', {'id': story.user.userId}) }}"> {{ story.user.username }}</a>
                                    {% endif %}
                                </h5>
                                <p class="card-text">
                                    <div class='content'>{{ story.storyText|slice(0, 100)|raw }}...</div>
                                    <div class='dateTime'>{{ story.datetime|date('Y-m-d H:i:s') }}</div>
                                </p>
                            </div>
                        </div>
                        {% set storiesNumber = storiesNumber + 1 %}
                    {% endif %}
                {% endfor %}
            {% else %}
                {% set storiesNumber = 0 %}
            {% endif %}
            {% if storiesNumber == 0 %}
                    <h4 class="m-2">{{ user.username }} has not posted any public stories yet!</h4>
            {% endif %}
        {% endif %}
    {% else %}
        User not found
    {% endif %}

    </div>
{% endblock %}